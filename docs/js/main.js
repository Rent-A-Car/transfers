let CONETCSTATE=1;d=document,window.addEventListener("load",()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(e=>{e.onupdatefound=(e=>{window.location.reload()}),console.log("Service worker successfully registered")}).catch(e=>{console.log("Service worker registration failed",e)})}),Swiper(d.getElementById("sidenav"),closeSidebarNav,4);const DetectConection=()=>{navigator.onLine?(console.log("online"),CONETCSTATE=1,d.getElementById("reloadnavbutton").classList.remove("d-none"),d.getElementById("offlinnavbutton").classList.add("d-none")):(console.log("offline"),CONETCSTATE=0,d.getElementById("reloadnavbutton").classList.add("d-none"),d.getElementById("offlinnavbutton").classList.remove("d-none"))};function openSidebarNav(){d.getElementById("sidenav").style.width="80%",d.getElementById("SidebarOpasity").style.width="100%",d.getElementById("SidebarOpasity").style.opacity="0.6"}function closeSidebarNav(){d.getElementById("sidenav").style.width="0",d.getElementById("SidebarOpasity").style.opacity="0.5",d.getElementById("SidebarOpasity").style.width="0px"}function ShowToastMessage(e="",t="primary",n=1300){return new Promise((a,o)=>{let s=d.createElement("div");switch(s.style="bottom:12%;left:50%;transform:translateX(-50%);z-index:2;position:fixed",t){case"primary":t="alert-primary";break;case"warning":t="alert-warning";break;case"danger":t="alert-danger";break;default:t="alert-"+t}s.innerHTML='<div class="alert '+t+'" role=alert style="padding:.4em 1em;border-radius:30px">'+e+"</div>",d.body.append(s),s.style.animation="backInUp 1s both",setTimeout(()=>{s.style.animation="fadeOutDown 1s both",setTimeout(()=>{s.remove(),a()},1e3)},n+1e3)})}navigator.connection&&(console.log("have conn"),"onchange"in navigator.connection?(console.log("have onchange"),navigator.connection.onchange=DetectConection):"ontypechange"in navigator.connection&&(console.log("have ontypechange"),navigator.connection.ontypechange=DetectConection),DetectConection()),d.getElementById("menuopenbutton").addEventListener("click",openSidebarNav),d.getElementById("reloadnavbutton").addEventListener("click",()=>{startLoading(),page=sessionStorage.getItem("page"),data=JSON.parse(sessionStorage.getItem("pdata")),page in PAGERENDER&&(f=PAGERENDER[page],f(data))}),d.getElementById("searchnavbutton").addEventListener("click",()=>{d.getElementById("searchnavbutton").classList.add("d-none"),d.getElementById("searchclsbutton").classList.remove("d-none"),d.getElementById("searchinput").classList.remove("d-none"),d.querySelector("#searchinput input").focus()}),d.getElementById("searchclsbutton").addEventListener("click",()=>{d.getElementById("searchnavbutton").classList.remove("d-none"),d.getElementById("searchclsbutton").classList.add("d-none"),d.getElementById("searchinput").classList.add("d-none"),d.querySelector("#searchinput input").value="",page=sessionStorage.getItem("page"),page in PAGESEARCH&&(f=PAGESEARCH[page],eval(f+"('')"))});const API=(()=>{let e=e=>(()=>new Promise((e,t)=>{firebase.auth().currentUser.getIdToken().then(e,t)}))().then(t=>{let n=new URL("https://script.google.com/macros/s/AKfycbz6fGzgSxLaCwhjcvvxFTcWRJHV5jKXyFvS0KljbUbjtW9CGKjY6-j8/exec");e&&(n.search=new URLSearchParams(e).toString());let a=new Request(n.toString(),{method:"POST",body:t});return console.log(a),fetch(a).then(e=>{if(console.log(e),408==e.status)throw"408";return e}).then(e=>e.json()).catch(e=>(console.log(e),ShowToastMessage("Плохое интернет соединение, попробуйте похоже","danger"),!1))});return{signUp:t=>e({a:"signup",atk:t}),loginIn:t=>e({a:"login",atk:t}),like:async t=>(dfs=await e({a:"like",drv:t}),dfs?JSON.parse(dfs.likes):dfs),dislike:async t=>(dfs=await e({a:"dislike",drv:t}),dfs?JSON.parse(dfs.likes):dfs)}})();