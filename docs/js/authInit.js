!("firebase"in window&&CONETCSTATE)&&go2Page(...curPage()),firebase.initializeApp({apiKey:"AIzaSyChvee1gUsGHeV5rJ6JTCiFGTnVQlRbxKk",authDomain:"transfers4me.firebaseapp.com",projectId:"transfers4me",storageBucket:"transfers4me.appspot.com",messagingSenderId:"264089197452",appId:"1:264089197452:web:8aac1bb44f6f0b94a054a9"});const loginIn=e=>{let o=new firebase.auth.GoogleAuthProvider;if(o.addScope("profile"),o.addScope("email"),o.addScope("openid"),e)if("object"==typeof e)for(var t=0;t<e.length;t++)o.addScope(e[t]);else"string"==typeof e&&o.addScope(e);function n(e){console.log(e);let o=document.getElementById("errorLogin");switch(e.code){case"auth/user-disabled":o.innerHTML="Ваш аккаунт заблокирован. Свяжитесь с <a class=text-secondary href=mailto:arendamontenegro.car+transfers@gmail.com>администратором</a>";break;case"login/connectError":o.innerText=e.message,loginOut(!1);break;default:o.innerText=e.message}o.classList.remove("d-none"),console.log("show error")}firebase.auth().signInWithPopup(o).then(e=>{console.log(e);e.additionalUserInfo.profile.granted_scopes.split(" ");let o=window.localStorage;o.setItem("token",e.credential.accessToken.split("").reverse().join("")),o.setItem("auth",!0);const t={message:"Ошибка подключения к серверу",code:"login/connectError"};e.additionalUserInfo.isNewUser?API.signUp(e.credential.accessToken).then(e=>{if(!1===e)return n(t);console.log("signup",e),loginModal.hide(),localStorage.setItem("likes",e.likes),e.isDriver}):API.loginIn(e.credential.accessToken).then(e=>{if(!1===e)return n(t);console.log("loginIn",e),loginModal.hide(),localStorage.setItem("likes",e.likes),e.isDriver}),firebase.auth().currentUser=e.user}).catch(n)},loginOut=(e=!1)=>{firebase.auth().signOut().then(()=>{e&&document.getElementById("errorLogin").classList.add("d-none"),console.log("ok logout"),window.localStorage.setItem("auth",!1)}).catch(e=>{alert(e)})};document.getElementById("google-login-in")&&document.getElementById("google-login-in").addEventListener("click",loginIn),document.getElementById("google-login-out")&&document.getElementById("google-login-out").addEventListener("click",loginOut);let loginModal=new bootstrap.Modal(document.getElementById("loginModal"),{keyboard:!1,backdrop:"static"});firebase.auth().onAuthStateChanged(function(e){console.log("onAuthStateChanged"),e&&window.localStorage.getItem("auth")?(loginModal.hide(),firebase.auth().currentUser=e,document.getElementById("emailDispl").innerText=e.email,go2Page(...curPage())):loginModal.show()});