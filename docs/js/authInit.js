firebase.initializeApp({apiKey:"AIzaSyChvee1gUsGHeV5rJ6JTCiFGTnVQlRbxKk",authDomain:"transfers4me.firebaseapp.com",projectId:"transfers4me",storageBucket:"transfers4me.appspot.com",messagingSenderId:"264089197452",appId:"1:264089197452:web:8aac1bb44f6f0b94a054a9"});const loginIn=e=>{let o=new firebase.auth.GoogleAuthProvider;if(o.addScope("profile"),o.addScope("email"),o.addScope("openid"),o.addScope("https://www.googleapis.com/auth/user.phonenumbers.read"),e)if("object"==typeof e)for(var t=0;t<e.length;t++)o.addScope(e[t]);else"string"==typeof e&&o.addScope(e);firebase.auth().signInWithPopup(o).then(e=>{let o=e.additionalUserInfo.profile.granted_scopes.split(" "),t=window.localStorage;if(!o.includes("https://www.googleapis.com/auth/user.phonenumbers.read"))throw t.setItem("auth",!1),{code:"login/no-phone-accept",message:"Для авторизации разрешите доступ до вашего номера телефона"};t.setItem("token",e.credential.accessToken.split("").reverse().join("")),t.setItem("auth",!0),firebase.auth().currentUser=e.user}).catch(e=>{console.log(e);let o=document.getElementById("errorLogin");switch(e.code){case"auth/user-disabled":o.innerHTML="Ваш аккаунт заблокирован. Свяжитесь с <a class=text-secondary href=mailto:arendamontenegro.car+transfers@gmail.com>администратором</a>";break;case"login/no-phone-accept":o.innerText=e.message,firebase.auth().currentUser.delete();break;default:o.innerText=e.message}o.classList.remove("d-none"),console.log("show error")})},loginOut=()=>{firebase.auth().signOut().then(()=>{document.getElementById("errorLogin").classList.add("d-none"),console.log("ok logout"),window.localStorage.setItem("auth",!1)}).catch(e=>{alert(e)})};document.getElementById("google-login-in")&&document.getElementById("google-login-in").addEventListener("click",loginIn),document.getElementById("google-login-out")&&document.getElementById("google-login-out").addEventListener("click",loginOut);let loginModal=new bootstrap.Modal(document.getElementById("loginModal"),{keyboard:!1,backdrop:"static"});firebase.auth().onAuthStateChanged(function(e){e&&window.localStorage.getItem("auth")?(console.log("hide",e),loginModal.hide()):(loginModal.show(),console.log("show"))});